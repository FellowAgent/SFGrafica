import { splitSQLStatements } from './supabase/functions/_shared/sql-utils.ts';\nconst sql = CREATE OR REPLACE FUNCTION public.assign_master_role(p_user_id uuid)\nRETURNS void\nLANGUAGE plpgsql\nSECURITY DEFINER\nSET search_path TO 'public'\nAS $\nDECLARE\n  master_count integer;\nBEGIN\n  SELECT COUNT(*) INTO master_count\n  FROM public.user_roles\n  WHERE role = 'master';\n  IF master_count > 0 THEN\n    RAISE EXCEPTION 'Master user already exists';\n  END IF;\n  INSERT INTO public.user_roles (user_id, role)\n  VALUES (p_user_id, 'master');\nEND;\n$;\n;\nconst statements = splitSQLStatements(sql);\nconsole.log('count', statements.length);\nconsole.log('stmt', statements[0]);\n
